<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../javadoc.css" title="Style">
</head>
<body>
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span><a name="line.1">package com.box.sdk;</a>
<span class="sourceLineNo">002</span><a name="line.2"></a>
<span class="sourceLineNo">003</span><a name="line.3">import java.net.URL;</a>
<span class="sourceLineNo">004</span><a name="line.4">import java.util.Iterator;</a>
<span class="sourceLineNo">005</span><a name="line.5"></a>
<span class="sourceLineNo">006</span><a name="line.6">import com.eclipsesource.json.JsonArray;</a>
<span class="sourceLineNo">007</span><a name="line.7">import com.eclipsesource.json.JsonObject;</a>
<span class="sourceLineNo">008</span><a name="line.8">import com.eclipsesource.json.JsonValue;</a>
<span class="sourceLineNo">009</span><a name="line.9"></a>
<span class="sourceLineNo">010</span><a name="line.10">/**</a>
<span class="sourceLineNo">011</span><a name="line.11"> * Collections contain information about the items contained inside of them, including files and folders. The only</a>
<span class="sourceLineNo">012</span><a name="line.12"> * collection available currently is a “Favorites” collection.</a>
<span class="sourceLineNo">013</span><a name="line.13"> *</a>
<span class="sourceLineNo">014</span><a name="line.14"> * &lt;p&gt;Unless otherwise noted, the methods in this class can throw an unchecked {@link BoxAPIException} (unchecked</a>
<span class="sourceLineNo">015</span><a name="line.15"> * meaning that the compiler won't force you to handle it) if an error occurs. If you wish to implement custom error</a>
<span class="sourceLineNo">016</span><a name="line.16"> * handling for errors related to the Box REST API, you should capture this exception explicitly.&lt;/p&gt;</a>
<span class="sourceLineNo">017</span><a name="line.17"> */</a>
<span class="sourceLineNo">018</span><a name="line.18">@BoxResourceType("collection")</a>
<span class="sourceLineNo">019</span><a name="line.19">public class BoxCollection extends BoxResource implements Iterable&lt;BoxItem.Info&gt; {</a>
<span class="sourceLineNo">020</span><a name="line.20"></a>
<span class="sourceLineNo">021</span><a name="line.21">    /**</a>
<span class="sourceLineNo">022</span><a name="line.22">     * Get Collections URL Template.</a>
<span class="sourceLineNo">023</span><a name="line.23">     */</a>
<span class="sourceLineNo">024</span><a name="line.24">    public static final URLTemplate GET_COLLECTIONS_URL_TEMPLATE = new URLTemplate("collections/");</a>
<span class="sourceLineNo">025</span><a name="line.25">    /**</a>
<span class="sourceLineNo">026</span><a name="line.26">     * Get Collection Items URL Template.</a>
<span class="sourceLineNo">027</span><a name="line.27">     */</a>
<span class="sourceLineNo">028</span><a name="line.28">    public static final URLTemplate GET_COLLECTION_ITEMS_URL = new URLTemplate("collections/%s/items/");</a>
<span class="sourceLineNo">029</span><a name="line.29"></a>
<span class="sourceLineNo">030</span><a name="line.30">    /**</a>
<span class="sourceLineNo">031</span><a name="line.31">     * Constructs a BoxCollection for a collection with a given ID.</a>
<span class="sourceLineNo">032</span><a name="line.32">     * @param   api the API connection to be used by the collection.</a>
<span class="sourceLineNo">033</span><a name="line.33">     * @param   id  the ID of the collection.</a>
<span class="sourceLineNo">034</span><a name="line.34">     */</a>
<span class="sourceLineNo">035</span><a name="line.35">    public BoxCollection(BoxAPIConnection api, String id) {</a>
<span class="sourceLineNo">036</span><a name="line.36">        super(api, id);</a>
<span class="sourceLineNo">037</span><a name="line.37">    }</a>
<span class="sourceLineNo">038</span><a name="line.38"></a>
<span class="sourceLineNo">039</span><a name="line.39">    /**</a>
<span class="sourceLineNo">040</span><a name="line.40">     * Gets an iterable of all the collections for the given user.</a>
<span class="sourceLineNo">041</span><a name="line.41">     * @param  api the API connection to be used when retrieving the collections.</a>
<span class="sourceLineNo">042</span><a name="line.42">     * @return     an iterable containing info about all the collections.</a>
<span class="sourceLineNo">043</span><a name="line.43">     */</a>
<span class="sourceLineNo">044</span><a name="line.44">    public static Iterable&lt;BoxCollection.Info&gt; getAllCollections(final BoxAPIConnection api) {</a>
<span class="sourceLineNo">045</span><a name="line.45">        return new Iterable&lt;BoxCollection.Info&gt;() {</a>
<span class="sourceLineNo">046</span><a name="line.46">            public Iterator&lt;BoxCollection.Info&gt; iterator() {</a>
<span class="sourceLineNo">047</span><a name="line.47">                URL url = GET_COLLECTIONS_URL_TEMPLATE.build(api.getBaseURL());</a>
<span class="sourceLineNo">048</span><a name="line.48">                return new BoxCollectionIterator(api, url);</a>
<span class="sourceLineNo">049</span><a name="line.49">            }</a>
<span class="sourceLineNo">050</span><a name="line.50">        };</a>
<span class="sourceLineNo">051</span><a name="line.51">    }</a>
<span class="sourceLineNo">052</span><a name="line.52"></a>
<span class="sourceLineNo">053</span><a name="line.53">    /**</a>
<span class="sourceLineNo">054</span><a name="line.54">     * Returns an iterable containing the items in this collection. Iterating over the iterable returned by this method</a>
<span class="sourceLineNo">055</span><a name="line.55">     * is equivalent to iterating over this BoxCollection directly.</a>
<span class="sourceLineNo">056</span><a name="line.56">     * @return an iterable containing the items in this collection.</a>
<span class="sourceLineNo">057</span><a name="line.57">     */</a>
<span class="sourceLineNo">058</span><a name="line.58">    public Iterable&lt;BoxItem.Info&gt; getItems() {</a>
<span class="sourceLineNo">059</span><a name="line.59">        return this;</a>
<span class="sourceLineNo">060</span><a name="line.60">    }</a>
<span class="sourceLineNo">061</span><a name="line.61"></a>
<span class="sourceLineNo">062</span><a name="line.62">    /**</a>
<span class="sourceLineNo">063</span><a name="line.63">     * Returns an iterable containing the items in this collection and specifies which attributes to include in the</a>
<span class="sourceLineNo">064</span><a name="line.64">     * response.</a>
<span class="sourceLineNo">065</span><a name="line.65">     * @param   fields  the fields to retrieve.</a>
<span class="sourceLineNo">066</span><a name="line.66">     * @return          an iterable containing the items in this collection.</a>
<span class="sourceLineNo">067</span><a name="line.67">     */</a>
<span class="sourceLineNo">068</span><a name="line.68">    public Iterable&lt;BoxItem.Info&gt; getItems(final String... fields) {</a>
<span class="sourceLineNo">069</span><a name="line.69">        return new Iterable&lt;BoxItem.Info&gt;() {</a>
<span class="sourceLineNo">070</span><a name="line.70">            @Override</a>
<span class="sourceLineNo">071</span><a name="line.71">            public Iterator&lt;BoxItem.Info&gt; iterator() {</a>
<span class="sourceLineNo">072</span><a name="line.72">                String queryString = new QueryStringBuilder().appendParam("fields", fields).toString();</a>
<span class="sourceLineNo">073</span><a name="line.73">                URL url = GET_COLLECTION_ITEMS_URL.buildWithQuery(getAPI().getBaseURL(), queryString, getID());</a>
<span class="sourceLineNo">074</span><a name="line.74">                return new BoxItemIterator(getAPI(), url);</a>
<span class="sourceLineNo">075</span><a name="line.75">            }</a>
<span class="sourceLineNo">076</span><a name="line.76">        };</a>
<span class="sourceLineNo">077</span><a name="line.77">    }</a>
<span class="sourceLineNo">078</span><a name="line.78"></a>
<span class="sourceLineNo">079</span><a name="line.79">    /**</a>
<span class="sourceLineNo">080</span><a name="line.80">     * Retrieves a specific range of items in this collection.</a>
<span class="sourceLineNo">081</span><a name="line.81">     * @param   offset  the index of the first item to retrieve.</a>
<span class="sourceLineNo">082</span><a name="line.82">     * @param   limit   the maximum number of items to retrieve after the offset.</a>
<span class="sourceLineNo">083</span><a name="line.83">     * @param   fields  the fields to retrieve.</a>
<span class="sourceLineNo">084</span><a name="line.84">     * @return          a partial collection containing the specified range of items.</a>
<span class="sourceLineNo">085</span><a name="line.85">     */</a>
<span class="sourceLineNo">086</span><a name="line.86">    public PartialCollection&lt;BoxItem.Info&gt; getItemsRange(long offset, long limit, String... fields) {</a>
<span class="sourceLineNo">087</span><a name="line.87">        QueryStringBuilder builder = new QueryStringBuilder()</a>
<span class="sourceLineNo">088</span><a name="line.88">                .appendParam("offset", offset)</a>
<span class="sourceLineNo">089</span><a name="line.89">                .appendParam("limit", limit);</a>
<span class="sourceLineNo">090</span><a name="line.90"></a>
<span class="sourceLineNo">091</span><a name="line.91">        if (fields.length &gt; 0) {</a>
<span class="sourceLineNo">092</span><a name="line.92">            builder.appendParam("fields", fields).toString();</a>
<span class="sourceLineNo">093</span><a name="line.93">        }</a>
<span class="sourceLineNo">094</span><a name="line.94"></a>
<span class="sourceLineNo">095</span><a name="line.95">        URL url = GET_COLLECTION_ITEMS_URL.buildWithQuery(getAPI().getBaseURL(), builder.toString(), getID());</a>
<span class="sourceLineNo">096</span><a name="line.96">        BoxAPIRequest request = new BoxAPIRequest(this.getAPI(), url, "GET");</a>
<span class="sourceLineNo">097</span><a name="line.97">        BoxJSONResponse response = (BoxJSONResponse) request.send();</a>
<span class="sourceLineNo">098</span><a name="line.98">        JsonObject responseJSON = JsonObject.readFrom(response.getJSON());</a>
<span class="sourceLineNo">099</span><a name="line.99"></a>
<span class="sourceLineNo">100</span><a name="line.100">        String totalCountString = responseJSON.get("total_count").toString();</a>
<span class="sourceLineNo">101</span><a name="line.101">        long fullSize = Double.valueOf(totalCountString).longValue();</a>
<span class="sourceLineNo">102</span><a name="line.102">        PartialCollection&lt;BoxItem.Info&gt; items = new PartialCollection&lt;BoxItem.Info&gt;(offset, limit, fullSize);</a>
<span class="sourceLineNo">103</span><a name="line.103">        JsonArray entries = responseJSON.get("entries").asArray();</a>
<span class="sourceLineNo">104</span><a name="line.104">        for (JsonValue entry : entries) {</a>
<span class="sourceLineNo">105</span><a name="line.105">            BoxItem.Info entryInfo = (BoxItem.Info) BoxResource.parseInfo(this.getAPI(), entry.asObject());</a>
<span class="sourceLineNo">106</span><a name="line.106">            if (entryInfo != null) {</a>
<span class="sourceLineNo">107</span><a name="line.107">                items.add(entryInfo);</a>
<span class="sourceLineNo">108</span><a name="line.108">            }</a>
<span class="sourceLineNo">109</span><a name="line.109">        }</a>
<span class="sourceLineNo">110</span><a name="line.110">        return items;</a>
<span class="sourceLineNo">111</span><a name="line.111">    }</a>
<span class="sourceLineNo">112</span><a name="line.112"></a>
<span class="sourceLineNo">113</span><a name="line.113">    /**</a>
<span class="sourceLineNo">114</span><a name="line.114">     * Returns an iterator over the items in this collection.</a>
<span class="sourceLineNo">115</span><a name="line.115">     * @return an iterator over the items in this collection.</a>
<span class="sourceLineNo">116</span><a name="line.116">     */</a>
<span class="sourceLineNo">117</span><a name="line.117">    @Override</a>
<span class="sourceLineNo">118</span><a name="line.118">    public Iterator&lt;BoxItem.Info&gt; iterator() {</a>
<span class="sourceLineNo">119</span><a name="line.119">        URL url = GET_COLLECTION_ITEMS_URL.build(this.getAPI().getBaseURL(), BoxCollection.this.getID());</a>
<span class="sourceLineNo">120</span><a name="line.120">        return new BoxItemIterator(BoxCollection.this.getAPI(), url);</a>
<span class="sourceLineNo">121</span><a name="line.121">    }</a>
<span class="sourceLineNo">122</span><a name="line.122"></a>
<span class="sourceLineNo">123</span><a name="line.123">    /**</a>
<span class="sourceLineNo">124</span><a name="line.124">     * Contains information about a BoxCollection.</a>
<span class="sourceLineNo">125</span><a name="line.125">     */</a>
<span class="sourceLineNo">126</span><a name="line.126">    public class Info extends BoxResource.Info {</a>
<span class="sourceLineNo">127</span><a name="line.127">        private String collectionType;</a>
<span class="sourceLineNo">128</span><a name="line.128">        private String name;</a>
<span class="sourceLineNo">129</span><a name="line.129"></a>
<span class="sourceLineNo">130</span><a name="line.130">        /**</a>
<span class="sourceLineNo">131</span><a name="line.131">         * Constructs an empty Info object.</a>
<span class="sourceLineNo">132</span><a name="line.132">         */</a>
<span class="sourceLineNo">133</span><a name="line.133">        public Info() {</a>
<span class="sourceLineNo">134</span><a name="line.134">            super();</a>
<span class="sourceLineNo">135</span><a name="line.135">        }</a>
<span class="sourceLineNo">136</span><a name="line.136"></a>
<span class="sourceLineNo">137</span><a name="line.137">        /**</a>
<span class="sourceLineNo">138</span><a name="line.138">         * Constructs an Info object by parsing information from a JSON string.</a>
<span class="sourceLineNo">139</span><a name="line.139">         * @param json the JSON string to parse.</a>
<span class="sourceLineNo">140</span><a name="line.140">         */</a>
<span class="sourceLineNo">141</span><a name="line.141">        public Info(String json) {</a>
<span class="sourceLineNo">142</span><a name="line.142">            super(json);</a>
<span class="sourceLineNo">143</span><a name="line.143">        }</a>
<span class="sourceLineNo">144</span><a name="line.144"></a>
<span class="sourceLineNo">145</span><a name="line.145">        /**</a>
<span class="sourceLineNo">146</span><a name="line.146">         * Constructs an Info object using an already parsed JSON object.</a>
<span class="sourceLineNo">147</span><a name="line.147">         * @param jsonObject the parsed JSON object.</a>
<span class="sourceLineNo">148</span><a name="line.148">         */</a>
<span class="sourceLineNo">149</span><a name="line.149">        Info(JsonObject jsonObject) {</a>
<span class="sourceLineNo">150</span><a name="line.150">            super(jsonObject);</a>
<span class="sourceLineNo">151</span><a name="line.151">        }</a>
<span class="sourceLineNo">152</span><a name="line.152"></a>
<span class="sourceLineNo">153</span><a name="line.153">        /**</a>
<span class="sourceLineNo">154</span><a name="line.154">         * Gets the type of the collection.</a>
<span class="sourceLineNo">155</span><a name="line.155">         * @return the type of the collection.</a>
<span class="sourceLineNo">156</span><a name="line.156">         */</a>
<span class="sourceLineNo">157</span><a name="line.157">        public String getCollectionType() {</a>
<span class="sourceLineNo">158</span><a name="line.158">            return this.collectionType;</a>
<span class="sourceLineNo">159</span><a name="line.159">        }</a>
<span class="sourceLineNo">160</span><a name="line.160"></a>
<span class="sourceLineNo">161</span><a name="line.161">        /**</a>
<span class="sourceLineNo">162</span><a name="line.162">         * Gets the name of the collection.</a>
<span class="sourceLineNo">163</span><a name="line.163">         * @return the name of the collection.</a>
<span class="sourceLineNo">164</span><a name="line.164">         */</a>
<span class="sourceLineNo">165</span><a name="line.165">        public String getName() {</a>
<span class="sourceLineNo">166</span><a name="line.166">            return this.name;</a>
<span class="sourceLineNo">167</span><a name="line.167">        }</a>
<span class="sourceLineNo">168</span><a name="line.168"></a>
<span class="sourceLineNo">169</span><a name="line.169">        @Override</a>
<span class="sourceLineNo">170</span><a name="line.170">        public BoxCollection getResource() {</a>
<span class="sourceLineNo">171</span><a name="line.171">            return BoxCollection.this;</a>
<span class="sourceLineNo">172</span><a name="line.172">        }</a>
<span class="sourceLineNo">173</span><a name="line.173"></a>
<span class="sourceLineNo">174</span><a name="line.174">        @Override</a>
<span class="sourceLineNo">175</span><a name="line.175">        protected void parseJSONMember(JsonObject.Member member) {</a>
<span class="sourceLineNo">176</span><a name="line.176">            super.parseJSONMember(member);</a>
<span class="sourceLineNo">177</span><a name="line.177"></a>
<span class="sourceLineNo">178</span><a name="line.178">            String memberName = member.getName();</a>
<span class="sourceLineNo">179</span><a name="line.179">            JsonValue value = member.getValue();</a>
<span class="sourceLineNo">180</span><a name="line.180">            if (memberName.equals("collection_type")) {</a>
<span class="sourceLineNo">181</span><a name="line.181">                this.collectionType = value.asString();</a>
<span class="sourceLineNo">182</span><a name="line.182">            } else if (memberName.equals("name")) {</a>
<span class="sourceLineNo">183</span><a name="line.183">                this.name = value.asString();</a>
<span class="sourceLineNo">184</span><a name="line.184">            }</a>
<span class="sourceLineNo">185</span><a name="line.185">        }</a>
<span class="sourceLineNo">186</span><a name="line.186">    }</a>
<span class="sourceLineNo">187</span><a name="line.187">}</a>




























































</pre>
</div>
</body>
</html>
